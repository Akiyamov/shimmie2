<?xml version="1.0"?>
<schema version="0.3">
	<!-- FIXME: mysql utf8ness -->
	<table name="comments">
		<field name="id" type="I"><key/><autoincrement/></field>
		<field name="image_id" type="I"><notnull/></field><!-- references -->
		<field name="owner_id" type="I"><notnull/></field><!-- references -->
		<field name="owner_ip" type="C" size="15"><notnull/></field>
		<field name="posted" type="T"><notnull/></field>
		<field name="end" type="T"><notnull/></field>
		<field name="comment" type="X" size="4000"><notnull/></field>
		<index name="comments__image_id"><col>image_id</col></index>
		<index name="comments__owner_ip"><col>owner_ip</col></index>
		<index name="comments__posted"><col>posted</col></index>
		<opt platform="mysql">DEFAULT CHARSET='utf8'</opt>
	</table>

	<sql>
		<query>DELETE FROM config WHERE name='ext_comments_version'</query>
		<query>INSERT INTO config(name, value) VALUES('ext_comments_version', 3)</query>
	</sql>
</schema>
